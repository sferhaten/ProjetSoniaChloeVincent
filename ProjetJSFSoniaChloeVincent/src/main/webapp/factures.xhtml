<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
<h:head>

	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Factures</title>


	<h:outputStylesheet name="css/bootstrap.css" rel="stylesheet" />

	<h:outputStylesheet name="css/datepicker3.css" rel="stylesheet" />
	<h:outputStylesheet name="css/styles.css" rel="stylesheet" />

</h:head>
<body>
<ui:include src="home.xhtml" />

	
	<div class="col-sm-9 col-sm-offset-3 col-lg-10 col-lg-offset-2 main">

		

		<h1 class="text-center">Factures Toto</h1>
		<br />

		<h:messages style="prenom:red"></h:messages>



		<h:form id="form">

			<p:panel id="panel" header="Choix du client">
				<p:messages id="msgs" />
				<h:panelGrid columns="3" cellpadding="5">

					<p:outputLabel id="idHotelLabel" for="idHotel"
						value="Nom d'hotel :" style="display:block" />
					<h:selectOneMenu id="idHotel" value="#{factureBean.idHotel}"
						required="true" style="width:200px; display:block">
						<f:selectItems value="#{factureBean.listeHotels}" var="h"
							itemValue="#{h.idHotel}" itemLabel="#{h.nomHotel}" />
						<f:ajax render="@form" listener="#{factureBean.getClientsHotel}"></f:ajax>
					</h:selectOneMenu>
					<br />

					<p:outputLabel id="idClientLabel" for="idPersonne"
						value="Nom du client :" style="display:block" />
					<h:selectOneMenu id="idPersonne" value="#{factureBean.idPersonne}"
						required="true" style="width:200px; display:block">
						<f:selectItems value="#{factureBean.listePersonnes}" var="p"
							itemValue="#{p.idPersonne}" itemLabel="#{p.nom}" />
						<f:ajax render="@form" listener="#{factureBean.getActivites}"></f:ajax>
					</h:selectOneMenu>
					<br />

				</h:panelGrid>


			</p:panel>


			<c:if test="#{factureBean.idPersonne > 0}">
				<p:panel id="activites" header="Activités non facturées du client">

					<br />
					<c:if test="#{fn:length(factureBean.listeReservations) > 0}">
						<p:dataTable paginator="true" rows="5"
							value="#{factureBean.listeReservations}" var="r"
							sortMode="multiple">


							<f:facet name="header">Réservations</f:facet>

							<p:column sortBy="#{r.idReservation}" headerText="Identifiant">
								<h:outputText value="#{r.idReservation}"></h:outputText>
							</p:column>

							<p:column sortBy="#{r.dateArrive}" headerText="Date d'arrivée">
								<h:outputText value="#{r.dateArrive}"></h:outputText>
							</p:column>

							<p:column sortBy="#{r.dateSortie}" headerText="Date de sortie">
								<h:outputText value="#{r.dateSortie}"></h:outputText>
							</p:column>

							<p:column sortBy="#{r.coutResa}"
								headerText="Coût de la réservation">
								<h:outputText value="#{r.coutResa}"></h:outputText>
							</p:column>

							<p:column sortBy="#{r.chambre.idChambre}" headerText="Chambre">
								<h:outputText value="#{r.chambre.idChambre}"></h:outputText>
							</p:column>


							<f:facet name="footer">
        			Le client a effectué #{fn:length(factureBean.listeReservations)} réservations.
    			</f:facet>

						</p:dataTable>
					</c:if>
					<c:if test="#{fn:length(factureBean.listeReservations) eq 0}">

						<h:outputText
							style="color:red;text-align:center;font-weight:bold;display: block"
							value="Le client n'a aucune réservation non facturée."></h:outputText>

					</c:if>

					<br />
					<br />

					<c:if test="#{fn:length(factureBean.listeConsommations) > 0}">
						<p:dataTable paginator="true" rows="5"
							value="#{factureBean.listeConsommations}" var="c"
							sortMode="multiple">

							<f:facet name="header">Consommations</f:facet>

							<p:column sortBy="#{c.idConsommation}" headerText="Identifiant">
								<h:outputText value="#{c.idConsommation}"></h:outputText>
							</p:column>

							<p:column sortBy="#{c.quantite}" headerText="Quantité">
								<h:outputText value="#{c.quantite}"></h:outputText>
							</p:column>

							<p:column sortBy="#{c.produit.nom}" headerText="Produit">
								<h:outputText value="#{c.produit.nom}"></h:outputText>
							</p:column>




							<f:facet name="footer">
        			Le client a effectué #{fn:length(factureBean.listeConsommations)} consommations.
    			</f:facet>

						</p:dataTable>

					</c:if>

					<c:if test="#{fn:length(factureBean.listeConsommations) eq 0}">

						<h:outputText
							style="color:red;text-align:center;font-weight:bold;display: block"
							value="Le client n'a aucune consommation non facturée."></h:outputText>

					</c:if>
					<br />

				</p:panel>

				<br />

				<p:commandButton value="Facturer"
					actionListener="#{reservationBean.add}" icon="ui-icon-check" />

				<br />
				<c:if test="#{fn:length(factureBean.listeConsommations) > 0}">
					<p:dataTable paginator="true" rows="5"
						value="#{factureBean.listeConsommations}" var="c"
						sortMode="multiple">

						<f:facet name="header">Consommations</f:facet>

						<p:column sortBy="#{c.idConsommation}" headerText="Identifiant">
							<h:outputText value="#{c.idConsommation}"></h:outputText>
						</p:column>

						<p:column sortBy="#{c.quantite}" headerText="Quantité">
							<h:outputText value="#{c.quantite}"></h:outputText>
						</p:column>

						<p:column sortBy="#{c.produit.nom}" headerText="Produit">
							<h:outputText value="#{c.produit.nom}"></h:outputText>
						</p:column>




						<f:facet name="footer">
        			Le client a effectué #{fn:length(factureBean.listeConsommations)} consommations.
    			</f:facet>

					</p:dataTable>

				</c:if>

				<c:if test="#{fn:length(factureBean.listeConsommations) eq 0}">

					<h:outputText
						style="color:red;text-align:center;font-weight:bold;display: block"
						value="Le client n'a aucune consommation non facturée."></h:outputText>

				</c:if>
















			</c:if>





		</h:form>





	</div>

	<!-- <h:outputScript name="js/jquery-1.11.1.min.js"></h:outputScript>
	<h:outputScript name="js/bootstrap.min.js"></h:outputScript>
	<h:outputScript name="js/chart.min.js"></h:outputScript>
	<h:outputScript name="js/chart-data.js"></h:outputScript>
	<h:outputScript name="js/easypiechart.js"></h:outputScript>
	<h:outputScript name="js/easypiechart-data.js"></h:outputScript>
	<h:outputScript name="js/bootstrap-datepicker.js"></h:outputScript>


	<h:outputScript name="js/lumino.glyphs.js" />
 -->
</body>
</html>